**ä¼šè¯æ¦‚è¦**
- æ ¹æ® [recoding1](.cursor/summaries/recoding1.md)ã€[recoding2](.cursor/summaries/recoding2.md)ã€[recoding3](.cursor/summaries/recoding3.md) ä¸‰ä»½æ‘˜è¦æ•´ç†å‡ºæœ¬æ‘˜è¦ï¼Œä½œä¸ºé¡¹ç›®çº§æ•´åˆæ¦‚è§ˆï¼›è¯¦ç»†å†å²ä¸å•ç‚¹å®Œæˆé¡¹è§å‰ä¸‰ä»½ã€‚

**å¼•ç”¨æ‘˜è¦**ï¼ˆå†æ¬¡ä¼šè¯æ—¶å…ˆè¯»ä»¥å»¶ç»­ä¸Šä¸‹æ–‡ï¼‰
- [recoding1](.cursor/summaries/recoding1.md)ï¼šé˜¶æ®µä¸€/äºŒï¼ˆé¡¹ç›®ç»“æ„ã€base è¿ç§»ä¸ç²¾ç®€ï¼‰ã€æ¨¡å—åŒ–ä¸æ”¶å°¾æµç¨‹ã€é˜¶æ®µä¸‰èµ·æ­¥ã€‚
- [recoding2](.cursor/summaries/recoding2.md)ï¼šé˜¶æ®µä¸‰ app é‡æ„ï¼ˆAppRunnerã€Retrofitã€Riverpodã€ä¸»é¢˜ã€Isar åŒå®ä¾‹ã€å®ä½“ JSONã€SourceStorageï¼‰ã€‚
- [recoding3](.cursor/summaries/recoding3.md)ï¼šæºç®¡ç†åˆ é™¤/ç¼–è¾‘ã€ç½‘é¡µå›½é™…åŒ–ã€app ç»“æ„é‡ç»„ã€é¡¹ç›®åˆ†æã€æ–‡æ¡£ä¸€è‡´æ€§ã€‚

**åç»­æ‘˜è¦**
- æ— ï¼ˆæœ¬æ‘˜è¦ä¸ºæ•´åˆæ¦‚è§ˆï¼›æ–°ä¼šè¯å¯ç»§ç»­åœ¨ recoding3/recoding4 ä¸Šè¿½åŠ å¾…åŠæˆ–æ–°å»ºä¸“é¢˜æ‘˜è¦ï¼‰ã€‚

---

## é¡¹ç›®æ¦‚è¦

sjgtv ä¸ºæ¨¡å—åŒ– Flutter TV åº”ç”¨ï¼š**base**ï¼ˆå…¬å…±åº“ï¼‰+ **app**ï¼ˆåº”ç”¨å±‚ï¼‰ã€‚å‚è€ƒ DTVï¼Œæ”¯æŒå¤šæ ¼å¼ä¸ç½‘ç»œæµæ’­æ”¾ã€ç”µè§†é¥æ§å™¨ä¼˜åŒ–ï¼›åˆå§‹åŒ–é…ç½®ä» `https://ktv.aini.us.kg/config.json` åŠ è½½ã€‚å½“å‰é˜¶æ®µä¸‰ï¼ˆapp é‡æ„ï¼‰å·²åŸºæœ¬å®Œæˆï¼Œé˜¶æ®µå››ï¼ˆæ ¸å¿ƒåŠŸèƒ½ï¼‰éƒ¨åˆ†å®Œæˆï¼Œå¾…åŠä»¥ TV/æ’­æ”¾ä½“éªŒã€ä»£ç†/æ ‡ç­¾ã€ä»£ç è´¨é‡ä¸ºä¸»ã€‚

---

## é˜¶æ®µä¸å½“å‰çŠ¶æ€

| é˜¶æ®µ | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| **é˜¶æ®µä¸€** é¡¹ç›®ç»“æ„æ­å»º | âœ… å®Œæˆ | base / app ç›®å½•ã€æ¨¡å—åŒ–ç»“æ„ |
| **é˜¶æ®µäºŒ** åŸºç¡€åº“è¿ç§» + base ç²¾ç®€ | âœ… å®Œæˆ | ä» root/base è¿ç§»ã€åˆ æœªä½¿ç”¨ä¾èµ–ä¸ debug æ¨¡å—ã€viewer ä¿ç•™ |
| **é˜¶æ®µä¸‰** åº”ç”¨ä»£ç è¿ç§»ä¸ app é‡æ„ | âœ… å®Œæˆ | DTV ä»£ç è¿å…¥ã€å…ˆ API åçŠ¶æ€ç®¡ç†ã€AppRunner/Retrofit/ApiService/Riverpodã€ä¸»é¢˜ç»Ÿä¸€ã€Isar åŒå®ä¾‹ã€å®ä½“ JSONã€æºç®¡ç†å¢åˆ æ”¹ã€app ç»“æ„æ‰å¹³åŒ–ï¼ˆç§»é™¤ src/app åµŒå¥—ï¼‰ã€L10n ä¸ç½‘é¡µå›½é™…åŒ– |
| **é˜¶æ®µå››** æ ¸å¿ƒåŠŸèƒ½ | ğŸ”„ è¿›è¡Œä¸­ | æºç®¡ç†ï¼ˆå«åˆ é™¤/ç¼–è¾‘ï¼‰âœ…ï¼›è§†é¢‘æ’­æ”¾ï¼ˆMediaKitï¼‰å·²æœ‰åŸºç¡€ï¼›TV ä¼˜åŒ–/æœç´¢/å¹¿å‘Šè¿‡æ»¤/ä»£ç†/æ ‡ç­¾å¾…æ¨è¿› |

---

## æœªå®Œæˆçš„è®¡åˆ’ï¼ˆåˆå¹¶è‡ªä¸‰ä»½æ‘˜è¦ï¼‰

**åŠŸèƒ½ä¸ä½“éªŒ**
- [ ] **go_route**ï¼šè®¡åˆ’ä½¿ç”¨ go_route åšåº”ç”¨è·¯ç”±ã€‚
- [ ] **Flutter ä»£ç†/æ ‡ç­¾**ï¼ˆè‹¥éœ€è¦ï¼‰ï¼šç½‘é¡µå·²æœ‰ä»£ç†/æ ‡ç­¾ç®¡ç†ï¼›æ˜¯å¦åœ¨ app å†…åšä»£ç†ç®¡ç†é¡µã€æ ‡ç­¾ç®¡ç†é¡µï¼Œå¾…å®šã€‚
- [ ] **TV ä¸æ’­æ”¾**ï¼šç»§ç»­ä¼˜åŒ– TV ç„¦ç‚¹ã€é¥æ§ã€æ’­æ”¾å™¨ UI/äº¤äº’ï¼›è§†é¢‘æ’­æ”¾ï¼ˆMediaKitï¼‰å·²æœ‰åŸºç¡€ï¼Œå¾…ä¼˜åŒ–/å®Œå–„ã€‚
- [ ] **æœç´¢åŠŸèƒ½**ï¼šå·²æœ‰åŸºç¡€å®ç°ï¼Œå¾…ä¼˜åŒ–ä½“éªŒã€‚
- [ ] **å¹¿å‘Šè¿‡æ»¤**ï¼šå·²æœ‰ m3u8_ad_removerï¼Œå¾…å®Œå–„æˆ–æ‰©å±•ã€‚

**è´¨é‡ä¸ç²¾ç®€**
- [ ] **ä»£ç è´¨é‡**ï¼šå†è·‘ä¸€é `dart analyze` / `dart fix`ï¼ŒæŸ¥æœªä½¿ç”¨å¯¼å…¥ä¸æ­»ä»£ç ã€‚
- [ ] **æµ‹è¯•**ï¼ˆå¯é€‰ï¼‰ï¼šä¸šåŠ¡é€»è¾‘ä¸ API å¥‘çº¦æš‚æ— å•å…ƒæµ‹è¯•ï¼Œå¯åç»­è¡¥å……ã€‚
- [ ] **ç²¾ç®€**ï¼ˆå¯é€‰ï¼‰ï¼šbase çš„ viewer æ¨¡å—ã€Isar æ¢ Hive/SP ç­‰ï¼ŒæŒ‰éœ€æ’æœŸã€‚

**å»ºè®®ä¼˜å…ˆçº§**ï¼ˆæ¥è‡ª recoding3 é¡¹ç›®åˆ†æç»“è®ºï¼‰
- ä¼˜å…ˆï¼šTV ä¸æ’­æ”¾ä½“éªŒä¼˜åŒ–ã€‚
- æŒ‰éœ€ï¼šè‹¥éœ€åœ¨ app å†…ç®¡ç†ä»£ç†/æ ‡ç­¾å†è¡¥é¡µã€‚
- é¡ºæ‰‹ï¼šä»£ç è´¨é‡ä¸æµ‹è¯•å¯åœ¨æ—¥å¸¸è¿­ä»£ä¸­åšã€‚

**å·²å®Œæˆï¼ˆä»…åˆ—å…³é”®ï¼Œç»†èŠ‚è§ recoding1/2/3ï¼‰**
- [x] é˜¶æ®µä¸€/äºŒ/ä¸‰å…¨éƒ¨é¡¹ï¼›Flutter æºç®¡ç†å¢åˆ æ”¹ä¸ sourcesProviderï¼›ç½‘é¡µå›½é™…åŒ–ï¼ˆGET /api/l10n + data-i18nï¼‰ï¼›app æ–‡ä»¶ç»“æ„é‡ç»„ï¼›é‡æ–°åˆ†æé¡¹ç›®ï¼›æ–‡æ¡£ä¸€è‡´æ€§ï¼ˆapp/README æŠ€æœ¯æ ˆæŒ‰ pubspec æ›´æ–°ï¼‰ã€‚

---

## é¡¹ç›®ç»“æ„ï¼ˆappï¼Œä¸šåŠ¡ > èŒè´£ï¼‰

```
app/lib/src/
â”œâ”€â”€ source/       # æ•°æ®æºä¸šåŠ¡
â”‚   â”œâ”€â”€ model/
â”‚   â”œâ”€â”€ provider/
â”‚   â”œâ”€â”€ l10n/
â”‚   â””â”€â”€ page/
â”œâ”€â”€ proxy/        # ä»£ç†ä¸šåŠ¡
â”‚   â”œâ”€â”€ model/
â”‚   â””â”€â”€ provider/
â”œâ”€â”€ tag/          # æ ‡ç­¾ä¸šåŠ¡
â”‚   â”œâ”€â”€ model/
â”‚   â””â”€â”€ provider/
â”œâ”€â”€ movie/        # ç”µå½±ä¸šåŠ¡
â”‚   â”œâ”€â”€ model/
â”‚   â”œâ”€â”€ page/     # categoryã€searchã€detailã€full_screen_playerã€player_intents
â”‚   â”œâ”€â”€ service/  # m3u8_ad_remover
â”‚   â””â”€â”€ widget/   # focusable_movie_cardã€network_image_placeholders
â”œâ”€â”€ app/api/      # è¿œç¨‹ APIï¼šConfigApiï¼ˆconfig.jsonï¼‰
â”œâ”€â”€ shelf/        # ç‹¬ç«‹ä¸šåŠ¡ï¼šShelfApi å•ä¾‹ï¼Œæ··å…¥ ShelfApiL10nMixinï¼›HTTP æœåŠ¡ï¼Œè°ƒç”¨ provider è¯»å†™æ•°æ®
â”‚   â”œâ”€â”€ api.dart  # ShelfApi è·¯ç”±ä¸ handler
â”‚   â””â”€â”€ l10n/     # api_l10nï¼ˆshelf API æ¶ˆæ¯ï¼‰ã€web_l10nï¼ˆindex.html ç½‘é¡µä¸“å±ï¼‰
â””â”€â”€ app/          # åº”ç”¨çº§
    â”œâ”€â”€ api/      # ConfigApiï¼ˆè¿œç¨‹é…ç½®ï¼‰
    â”œâ”€â”€ provider/ # config_api_providerã€json_adapter_provider
    â”œâ”€â”€ runner/   # sjgtv_runner
    â”œâ”€â”€ theme/
    â””â”€â”€ widget/   # update_checker
```

---

## æºç®¡ç† / ä»£ç† / æ ‡ç­¾ï¼šç½‘é¡µ vs Flutter

- **ç½‘é¡µ**ï¼š`app/assets/web/index.html`ï¼Œshelf ç«¯å£ 8023ï¼›TV/å¹³æ¿æ‰«ç æ‰“å¼€ï¼›æº/ä»£ç†/æ ‡ç­¾å¢åˆ æ”¹æŸ¥ä¸æ’åºå‡å·²å®ç°ï¼›å·²æ¥å…¥ GET /api/l10n ä¸ data-i18n å›½é™…åŒ–ã€‚
- **Flutter**ï¼šSourceManagePageï¼ˆæºåˆ—è¡¨ã€å¯ç”¨/ç¦ç”¨ã€åˆ é™¤ã€ç¼–è¾‘ã€è¿› AddSourcePageï¼‰ã€AddSourcePageï¼ˆæ·»åŠ /ç¼–è¾‘æºï¼‰ï¼›ä»£ç†/æ ‡ç­¾æš‚æ—  Flutter é¡µã€‚

---

## é¡¹ç›®åˆ†æç»“è®ºï¼ˆ2026-01-31ï¼Œæ‘˜è¦ï¼‰

- **æ¶æ„**ï¼šbase + app æ¨¡å—åŒ–æ¸…æ™°ï¼›SjgtvRunner æ³¨å…¥ L10nã€Isar schemaã€API å®¢æˆ·ç«¯ä¸ JSON é€‚é…å™¨ï¼Œç»“æ„åˆç†ã€‚
- **ä»£ç è´¨é‡**ï¼šbase ä¸ app å‡ `dart analyze` æ— é”™è¯¯ï¼›`dart fix --dry-run` æ— å¾…ä¿®å¤é¡¹ã€‚
- **ä¾èµ–**ï¼šapp ä¸ base ç‰ˆæœ¬å·²å¯¹é½ï¼›retrofit 4.9.0 é€šè¿‡ dependency_overrides å›ºå®šã€‚
- **æµ‹è¯•**ï¼šapp ä»…æœ‰ api_server_testï¼ˆshelf + Providerï¼‰ï¼›æ— ä¸šåŠ¡/API å•å…ƒæµ‹è¯•ï¼Œå¯åç»­è¡¥å……ã€‚
- **æ–‡æ¡£**ï¼šæ ¹ README ä¸ app/README å·²æŒ‰ä¾èµ–æ›´æ–°ï¼ˆå« media_kitã€riverpodã€shelf ç­‰ï¼‰ã€‚

---

## ç½‘é¡µå›½é™…åŒ–ï¼ˆå·²å®ç°æ‘˜è¦ï¼‰

- shelf æä¾› `GET /api/l10n`ï¼Œè¿‡æ»¤ `web_` å‰ç¼€è¿”å›ç¿»è¯‘ JSONï¼›è¯­è¨€è·Ÿéš Flutter å½“å‰è¯­è¨€ã€‚
- **web_l10n**ï¼ˆkeysPrefix: webï¼‰ï¼šindex.html ä¸“å±ï¼Œä¸ **source_l10n**ï¼ˆFlutter æºç®¡ç†é¡µï¼‰åˆ†ç¦»ï¼Œé¿å…å…±ç”¨ã€‚
- ç½‘é¡µå¯¹éœ€ç¿»è¯‘èŠ‚ç‚¹åŠ  `data-i18n` / `data-i18n-placeholder` / `data-i18n-title`ï¼ŒåŠ è½½æ—¶ `await applyL10n()` åè¯·æ±‚ `/api/l10n`ï¼Œæ›¿æ¢æ–‡æ¡ˆä¸ document.titleï¼›JS åŠ¨æ€æ¶ˆæ¯ç”¨ `t(key)`ã€`tReplace(key, {name})`ã€‚

---

## å¼€å‘åŸåˆ™ä¸å‚è€ƒ

- å¾ªåºæ¸è¿›ï¼Œæ¯æ­¥æ£€æŸ¥ä¿®å¤é”™è¯¯ï¼›åªå¤åˆ¶å¿…è¦ä»£ç ï¼›åªåœ¨æœ¬é¡¹ç›®ï¼ˆsjgtvï¼‰å†…ä¿®æ”¹ï¼Œä¸ä¿®æ”¹ rootã€DTVã€‚
- å½“å‰é¡¹ç›®ï¼š`~/projects/sjgtv`ã€‚å‚è€ƒé¡¹ç›®ï¼š`~/projects/root/base`ã€`~/projects/DTV`ï¼ˆåªè¯»å‚è€ƒï¼‰ã€‚
- æŠ€æœ¯æ ˆï¼šFlutter SDK â‰¥3.10ï¼›baseï¼ˆDioã€Isarã€Riverpodã€L10n ç­‰ï¼‰ï¼›appï¼ˆMediaKitã€Retrofitã€Riverpodã€shelfï¼‰ã€‚

---

## æ‘˜è¦é“¾è¯´æ˜

- **recoding1** â†’ **recoding2** â†’ **recoding3** â†’ **recoding4**ï¼šæŒ‰æ—¶é—´æ¨è¿›ï¼›recoding4 ä¸ºæ ¹æ®å‰ä¸‰ä»½æ•´ç†çš„æ•´åˆæ¦‚è§ˆï¼Œä¸æ›¿ä»£å‰ä¸‰ä»½ï¼›è¯¦ç»†å†å²ä¸å•æ¬¡å˜æ›´è§ recoding1/2/3ã€‚
- æ–°ä¼šè¯å»ºè®®ï¼šå…ˆè¯» recoding3 æˆ– recoding4 è·å–å½“å‰å¾…åŠä¸ç»“è®ºï¼›è‹¥éœ€æ›´æ—©ä¸Šä¸‹æ–‡å†è¯» recoding2ã€recoding1ã€‚

---

## å†å²

ï¼ˆæ¯æ¡é¡»ä¸ºã€ŒYYYY-MM-DD HH:mmã€æˆ–ã€ŒYYYY-MM-DD HH:mmï¼ˆè¯´æ˜ï¼‰ã€æ ¼å¼ã€‚ï¼‰

### 2026-01-31 22:00ï¼ˆåˆ›å»º recoding4ï¼Œæ ¹æ®ä¸‰ä»½æ‘˜è¦æ•´ç†ï¼‰
- æ ¹æ® recoding1ã€recoding2ã€recoding3 æ•´ç†ç¬¬å››ä»½æ‘˜è¦ recoding4.mdï¼Œä½œä¸ºé¡¹ç›®çº§æ•´åˆæ¦‚è§ˆã€‚
- å†…å®¹åŒ…å«ï¼šå¼•ç”¨/åç»­æ‘˜è¦ã€é¡¹ç›®æ¦‚è¦ã€é˜¶æ®µä¸å½“å‰çŠ¶æ€ã€æœªå®Œæˆçš„è®¡åˆ’ï¼ˆåˆå¹¶å»é‡ï¼‰ã€é¡¹ç›®ç»“æ„ã€æºç®¡ç†/ä»£ç†/æ ‡ç­¾å¯¹æ¯”ã€é¡¹ç›®åˆ†æç»“è®ºæ‘˜è¦ã€ç½‘é¡µå›½é™…åŒ–å·²å®ç°æ‘˜è¦ã€å¼€å‘åŸåˆ™ä¸å‚è€ƒã€æ‘˜è¦é“¾è¯´æ˜ã€‚

### 2026-01-31 22:10ï¼ˆå¾…åŠä¸å»ºè®®è¡¥å…¨ï¼Œæ— é—æ¼ï¼‰
- å¯¹ç…§ recoding2 é˜¶æ®µå››ä¸ recoding3 å¾…åŠæ ¸æŸ¥ï¼šè¡¥å…¥**æœç´¢åŠŸèƒ½**ï¼ˆå·²æœ‰åŸºç¡€ï¼Œå¾…ä¼˜åŒ–ï¼‰ã€**å¹¿å‘Šè¿‡æ»¤**ï¼ˆå·²æœ‰ m3u8_ad_removerï¼Œå¾…å®Œå–„ï¼‰ï¼›åœ¨ã€ŒTV ä¸æ’­æ”¾ã€ä¸­æ³¨æ˜è§†é¢‘æ’­æ”¾ï¼ˆMediaKitï¼‰å·²æœ‰åŸºç¡€ã€å¾…ä¼˜åŒ–ã€‚
- æ–°å¢**å»ºè®®ä¼˜å…ˆçº§**å°èŠ‚ï¼ˆæ¥è‡ª recoding3 é¡¹ç›®åˆ†æç»“è®ºï¼‰ï¼šä¼˜å…ˆ TV ä¸æ’­æ”¾ï¼›æŒ‰éœ€ä»£ç†/æ ‡ç­¾ï¼›é¡ºæ‰‹ä»£ç è´¨é‡ä¸æµ‹è¯•ã€‚

### 2026-02-01ï¼ˆè®¡åˆ’ä½¿ç”¨ go_routeï¼‰
- æœªå®Œæˆçš„è®¡åˆ’ï¼šè¡¥å…… **go_route**ï¼ˆè®¡åˆ’ä½¿ç”¨ go_route åšåº”ç”¨è·¯ç”±ï¼‰ã€‚

### 2026-02-01ï¼ˆapp æŒ‰ä¸šåŠ¡åˆ†ç±»é‡æ„ï¼‰
- app ç»“æ„æ”¹ä¸ºæŒ‰ä¸šåŠ¡åˆ†ç±»ï¼šsource/ï¼ˆmodelã€providerã€storageã€countã€l10nã€pageï¼‰ã€proxy/ã€tag/ã€movie/ å„è‡ªåŒ…å«å…¶ modelã€providerã€count ç­‰ï¼›api/ ä¿ç•™è·¨ä¸šåŠ¡å±‚ï¼›åˆ é™¤ model/ã€provider/ã€sources/ã€proxies/ã€tags/ã€count/ã€l10n/ ç­‰æŒ‰åŠŸèƒ½åˆ†ç±»çš„ç›®å½•ã€‚

### 2026-02-01ï¼ˆä¸šåŠ¡ä¸‹æŒ‰èŒè´£åˆ†å­ç›®å½•ï¼‰
- ä¸šåŠ¡ä¸‹å†æŒ‰èŒè´£åˆ†ï¼šsource/model/ã€source/provider/ã€source/l10n/ã€source/page/ï¼›proxy/model/ã€proxy/provider/ï¼›tag/model/ã€tag/provider/ï¼›movie/model/ã€movie/page/ã€movie/widget/ã€‚

### 2026-02-01ï¼ˆç§»é™¤ api å±‚ã€ConfigApiã€AppWrapperï¼‰
- **ç§»é™¤ api/**ï¼šFlutter UI ä¸å†é€šè¿‡ HTTP è°ƒç”¨ localhost è·å–æº/ä»£ç†/æ ‡ç­¾ï¼Œç›´æ¥ä½¿ç”¨ Riverpod providerã€‚
- **ConfigApi**ï¼šapp/api/config_api.dartï¼ŒRetrofit å•ä¾‹ï¼Œè°ƒç”¨è¿œç¨‹ config.jsonï¼›configApiProvider è¿”å›è¯·æ±‚ç»“æœ Mapã€‚
- **AppWrapper é€»è¾‘**ï¼šç§»è‡³ MovieHomePageï¼ˆcategory_page.dartï¼‰ï¼Œåˆ é™¤ app_wrapper.dartã€‚

### 2026-02-01ï¼ˆshelf/ç½‘é¡µ/æº l10n è°ƒæ•´ï¼‰
- **ShelfApi å•ä¾‹**ï¼šshelf api.dart å®šä¹‰ ShelfApi ç±»ï¼Œæ··å…¥ ShelfApiL10nMixinï¼Œå…¨éƒ¨æ–¹æ³•å…¥ç±»ï¼Œæ–¹æ³•å†…ç”¨ this.xxxL10n è·å–ç¿»è¯‘ã€‚
- **web_l10n**ï¼šæ–°å»º keysPrefix: webï¼Œindex.html ä¸“å±ï¼›handleGetL10n è¿‡æ»¤ web_ å‰ç¼€ï¼›è¡¥å…¨ç½‘é¡µå…¨éƒ¨æ–‡æ¡ˆ data-i18nã€JS ç”¨ t()/tReplace()ã€‚
- **source_l10n**ï¼šå»é™¤æ–¹æ³•åå†—ä½™å‰ç¼€ï¼ˆmanageTitleL10nã€listTitleL10nã€addTitleL10nã€nameL10nã€urlHintL10nï¼‰ï¼Œé¿å… source_source_xxx å åŠ ã€‚
